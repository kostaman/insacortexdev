C166 COMPILER V6.08, MON_STDIO_2007B                                                       06/28/2009 16:21:33 PAGE 1   


C166 COMPILER V6.08, COMPILATION OF MODULE MON_STDIO_2007B
OBJECT MODULE PLACED IN .\objs\mon_stdio_2007b.obj
COMPILER INVOKED BY: C:\Keil\Evalsoft\C166\BIN\C166.EXE mon_stdio_2007b.c TINY BROWSE INCDIR(.\archi_appli;..\..\..\tram
                    -poline-1.1\os;..\..\..\trampoline-1.1\com;..\..\..\trampoline-1.1\os\os_machine\c166;..\..\..\trampoline-1.1\goil\templa
                    -tes\c166;..\..\..\trampoline-1.1\debug) MOD167 DEFINE(WITH_COMPILER_SETTINGS) DEBUG OBJECT(.\objs\mon_stdio_2007b.obj) 

 stmt lvl     source

    1         /* STDIO_ASC.c ****************************************************************
    2          *      Entrées-Sorties série via le port asynchrone ASC en simu et en réel       *
    3          *  stdio.h est donc utilisable (printf etc.) et visualisables sur la         *
    4          *  "serial windows #1" de Keil.
    5          *   Septembre 2007 pascal Acco                                                                                           *
    6          ******************************************************************************
    7          ******************************************************************************
    8          * En mode réel, UTILISEZ la clé de compilation et d'assemblage MCB167NET.        *
    9          * En mode  simulé, EFFACEZ cette clé. (Onglets C166 et A166 du projet)           *
   10          ******************************************************************************
   11          * void Init_IO_ASC(void) : il faut lancer cette fonction en premier afin de  *
   12          *                      pouvoir bénéficier de la bibliothèque stdio et effectuer des E/S. *
   13          *                              - Mode réel : les E/S passent par la ligne ASC configurée par *
   14          *                 le moniteur: On fait rien donc !                           *
   15          *                              - Mode simulé : les E/S passent par la liasion série ASC      *
   16          *                                              (visu sur fenêtre SERIAL #1 de KEIL).                     *
   17          *                                                                                                                                                        *
   18          ******************************************************************************/
   19         
   20         #include <c167cs.h>
   21         #include <intrins.h>
   22         #include "mon_stdio_2007b.h"
   23         
   24         #define Trappe_Logicielle 0x50
   25         
   26           
   27         void Init_Mon_Stdio (void)
   28                 {
   29  1      #if(STDIO_MODE==STDIO_ASC_SIM)
   30  1      //# MODE SIMULE # MODE SIMULE # MODE SIMULE # MODE SIMULE # MODE SIMULE # MODE
   31  1              P3 = P3 | 0x0400;               /* La bascule 10 de sortie du port P3 doit être à '1'
   32  1                                      car elle est combinée par un ET avec la fonction alternative.
   33  1                                                                                                              (User's Manual, p. 7-7) */
   34  1              DP3 = DP3 | 0x0400;             // ligne P3.10 en sortie - TxD
   35  1              _nop_();                                // pipe-line !   (User's Manual, p. 4-8)
   36  1              DP3 = DP3 & 0xF7FF;             // ligne P3.11 en entrée - RxD
   37  1              _nop_();                                // pipe-line !
   38  1              S0TIC = 0x0080;                 // prêt à émettre, sans IT.
   39  1              S0RIC = 0;                              // rien reçu, sans IT itou.
   40  1              S0BG  = 0x0040;                 // vitesse : 9600 bauds.
   41  1      
   42  1      /*  S0CON : voir User's Manual, pp. 11-2 et 11-3.
   43  1                S0R   1   Générateur de bauds en marche                       S0CON.15
   44  1                S0LB  0   Usage normal, sans rebouclage                       S0CON.14
   45  1                S0BRS 0   Vitesse définie par S0BG.                           S0CON.13
   46  1                S0ODD 0   Parité.                                                                     S0CON.12
   47  1                 ---  0       --                                                                              S0CON.11
   48  1                S0OE  0   RAZ du drapeau d'erreur de débordement      S0CON.10
   49  1                S0FE  0   RAZ du drapeau d'erreur de trame            S0CON.9
   50  1                S0PE  0   RAZ du drapeau d'erreur de parité           S0CON.8
   51  1                S0OEN 0   Ignore les débordements                                     S0CON.7
   52  1                S0FEN 0   Ignore les erreurs de trame                         S0CON.6
   53  1                S0PEN 0   Ignore la parité                                            S0CON.5
C166 COMPILER V6.08, MON_STDIO_2007B                                                       06/28/2009 16:21:33 PAGE 2   

   54  1                S0REN 1   RECEPTEUR EN MARCHE !                                       S0CON.4
   55  1                S0STP 0   Trame avec 1 bit de stop                            S0CON.3
   56  1                S0M   001 Trame avec 8 bits de données, async.        S0CON.2-0
   57  1              ---------------
   58  1              c'est-à-dire  S0CON <-- 1000 0000 0001 0001b = 8011h
   59  1       */
   60  1              S0CON = 0x8011;
   61  1      #else
                      _nop_ ();
                      // Tout est configuré par le moniteur !!!
              #endif
   65  1      //# ENDIF # ENDIF # ENDIF # ENDIF # ENDIF # ENDIF # ENDIF # ENDIF # ENDIF # END
   66  1      }


MODULE INFORMATION:   INITIALIZED  UNINITIALIZED
  CODE SIZE        =          34     --------
  NEAR-CONST SIZE  =    --------     --------
  FAR-CONST SIZE   =    --------     --------
  HUGE-CONST SIZE  =    --------     --------
  XHUGE-CONST SIZE =    --------     --------
  NEAR-DATA SIZE   =    --------     --------
  FAR-DATA SIZE    =    --------     --------
  XHUGE-DATA SIZE  =    --------     --------
  IDATA-DATA SIZE  =    --------     --------
  SDATA-DATA SIZE  =    --------     --------
  BDATA-DATA SIZE  =    --------     --------
  HUGE-DATA SIZE   =    --------     --------
  BIT SIZE         =    --------     --------
  INIT'L SIZE      =    --------     --------
END OF MODULE INFORMATION.


C166 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
